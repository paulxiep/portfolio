# Quant Trading Gym - Docker Compose
# V3.7: Local development and demo setup

services:
  # ─────────────────────────────────────────────────────────────────────────
  # TUI Service: Browser-accessible terminal UI via ttyd
  # ─────────────────────────────────────────────────────────────────────────
  tui:
    build:
      context: .
      dockerfile: dockerfile/Dockerfile.tui
    ports:
      - "7681:7681"  # ttyd web interface
    environment:
      - SIM_TICKS=5000
      - SIM_TIER1=100
      - SIM_TIER2=500
      - SIM_POOL_SIZE=5000
      - SIM_TICK_DELAY=0  # 20 ticks/sec for smooth viewing
    # Uncomment for smaller demo:
    # environment:
    #   - SIM_TICKS=1000
    #   - SIM_TIER1=50
    #   - SIM_TIER2=200
    #   - SIM_POOL_SIZE=1000

  # ─────────────────────────────────────────────────────────────────────────
  # Headless Service: Benchmark/CI mode (no UI)
  # ─────────────────────────────────────────────────────────────────────────
  simulation:
    build:
      context: .
      dockerfile: dockerfile/Dockerfile.simulation
    environment:
      - SIM_HEADLESS=true
      - SIM_TICKS=10000
      - SIM_TIER1=100
      - SIM_TIER2=1000
      - SIM_POOL_SIZE=10000
    # Override for stress test:
    # command: ["--ticks", "100000", "--tier1", "500", "--pool-size", "50000"]
